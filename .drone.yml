kind: pipeline
name: default

steps: 
- name: init
  image: python
  commands:
  - pip install -r requirements.txt
  - py ./init_db.py


- name: build
  image: zssacbbt/docol


- name: docker
  image: plugins/docker
  settings:
    username: zssacbbt
    password: Zss1327230
    repo: zssacbbt/docolserver
    tags:
     - latest
     - '1.0.1'
     - '1.0'
  
services:
- name: database
  image: postgres:10-alpine
  ports:
  - 5432
  environment:
    POSTGRES_USER: saisi
    POSTGRES_PASSWORD: pass
    POSTGRES_DB: docol